import Data.List (sort)

-- Promedio/media
media :: [Double] -> Double
media xs = sum xs / fromIntegral (length xs)

-- Desvición estandar
desviacionEstandar :: [Double] -> Double
desviacionEstandar xs =
    let n = fromIntegral $ length xs
        m = media xs
        sumaCuadrados = sum [(x - m)^2 | x <- xs]
    in sqrt (sumaCuadrados / n)

-- Puntuación tipica
puntuacionTipica :: Double -> [Double] -> Double
puntuacionTipica x muestra = (x - media muestra) / desviacionEstandar muestra

-- Valores atipicos 
valoresAtipicos :: [Double] -> [Double]
valoresAtipicos muestra =
    let m = media muestra
        std = desviacionEstandar muestra
        puntuaciones = [puntuacionTipica x muestra | x <- muestra]
    in [x | (x, p) <- zip muestra puntuaciones, abs p > 3.0]


main :: IO ()
main = do
    let muestra = [10.0, 12.0, 14.0, 15.0, 9.0, 100.0, 800.0, 11.0]
        valoresAtipicosResultado = valoresAtipicos muestra
    putStrLn "Valores atípicos:"
    if null valoresAtipicosResultado
        then putStrLn "No se encontraron valores atípicos."
        else mapM_ print valoresAtipicosResultado
